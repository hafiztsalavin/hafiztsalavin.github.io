<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="map[name:Hafiz Tsalavin]">
<meta name="description" content="Hello everyone ! This week, I have been studying about one of most favorite design pattern, MVC, with Ruby Sinatra obviously. Actually, Ruby Sinatra doesn’t require to follow Model-View-Controller (MVC) design pattern for application what we will build, but building a MVC application with Sinatra can help learn how to pieces – models, view and controllers – work together. It was exciting and I want to share what I learned." />
<meta name="keywords" content=", learning, bootcamp" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="https://hafiztsalavin.github.io/posts/2021/07/mvc-using-ruby-sinatra/" />


    <title>
        
            MVC using Ruby Sinatra :: Hafiz Tsalavin 
        
    </title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="https://hafiztsalavin.github.io/main.aaa4299e94595dfb127122d343244362acc9c8619cdf790b520723c2c8071d90.css">




    <link rel="apple-touch-icon" sizes="180x180" href="https://hafiztsalavin.github.io/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://hafiztsalavin.github.io/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://hafiztsalavin.github.io/favicon-16x16.png">
    <link rel="manifest" href="https://hafiztsalavin.github.io/site.webmanifest">
    <link rel="mask-icon" href="https://hafiztsalavin.github.io/safari-pinned-tab.svg" color="#1b1c1d">
    <link rel="shortcut icon" href="https://hafiztsalavin.github.io/favicon.ico">
    <meta name="msapplication-TileColor" content="#1b1c1d">
    <meta name="theme-color" content="#1b1c1d">



<meta itemprop="name" content="MVC using Ruby Sinatra">
<meta itemprop="description" content="Hello everyone ! This week, I have been studying about one of most favorite design pattern, MVC, with Ruby Sinatra obviously. Actually, Ruby Sinatra doesn’t require to follow Model-View-Controller (MVC) design pattern for application what we will build, but building a MVC application with Sinatra can help learn how to pieces – models, view and controllers – work together. It was exciting and I want to share what I learned.">
<meta itemprop="datePublished" content="2021-07-25T00:00:00&#43;00:00" />
<meta itemprop="dateModified" content="2021-07-25T00:00:00&#43;00:00" />
<meta itemprop="wordCount" content="802">
<meta itemprop="image" content="https://hafiztsalavin.github.io/"/>



<meta itemprop="keywords" content="learning,bootcamp," />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://hafiztsalavin.github.io/"/>

<meta name="twitter:title" content="MVC using Ruby Sinatra"/>
<meta name="twitter:description" content="Hello everyone ! This week, I have been studying about one of most favorite design pattern, MVC, with Ruby Sinatra obviously. Actually, Ruby Sinatra doesn’t require to follow Model-View-Controller (MVC) design pattern for application what we will build, but building a MVC application with Sinatra can help learn how to pieces – models, view and controllers – work together. It was exciting and I want to share what I learned."/>






    <meta property="article:section" content="Development" />



    <meta property="article:published_time" content="2021-07-25 00:00:00 &#43;0000 UTC" />










    </head>

    
        <body>
    
    
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="https://hafiztsalavin.github.io/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">&gt;</span>
            <span class="logo__text">_ cd /hafiztsalavin/</span>
            <span class="logo__cursor" style=
                  "visibility:hidden;
                   
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="https://hafiztsalavin.github.io/about/">About</a></li><li><a href="https://hafiztsalavin.github.io/posts/">All Posts</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            
        </span>
    </span>
</header>


            <div class="content">
                

<div>
  
  <main class="post">

    <div class="post-info">
      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock">
          <circle cx="12" cy="12" r="10"></circle>
          <polyline points="12 6 12 12 16 14"></polyline>
        </svg>
        4 minutes

        
      </p>
    </div>

    <article>
      <h1 class="post-title">
        <a href="https://hafiztsalavin.github.io/posts/2021/07/mvc-using-ruby-sinatra/">MVC using Ruby Sinatra</a>
      </h1>

      

      

      

      <div style="text-align: justify;" class="post-content">
        <h3 id="hello-everyone-">Hello everyone !</h3>
<p>This week, I have been studying about one of most favorite design pattern, MVC, with Ruby Sinatra obviously. Actually, Ruby Sinatra doesn’t require to follow Model-View-Controller (MVC) design pattern for application what we will build, but building a MVC application with Sinatra can help learn how to pieces – models, view and controllers – work together. It was exciting and I want to share what I learned.</p>
<p>First things first, imagine we on the restaurant. So, the chef is the model of the application, the waiter is the controller and the view is the customer. The customer cannot directly converse with the chef, just like the views of the application cannot directly talk to the models. This is where controllers come in. The controller takes the information from the user and passes it to the models, the models deal with the database of the application and then send the information back to the controller and then renders to the erb file for the showing to the user.</p>
<p>So, like what the instructors said, if we want to starting a new project, the key is to think first is what models are you going to have. Lets imagine the simple application that can showing the all of item in database to the view with MVC.</p>
<p>Before building the application, we want to make sure connection the database. We need install the driver of mysql because we use mysql to the database and in the ruby the name of driver is <code>mysql2</code>. To the installation just run on the terminal:</p>
<p><code>gem install mysql2</code></p>
<p>To make sure the connection, we need file ruby to connect to the database. Let say we name it <code>db_connector.rb</code>. Oh ya, we can also use <code>environment variable</code> to the db connection. We can configure it in the file <code>.env</code> and fill it with db information. That suppose if we have an application with many features and each features need access to the database.</p>
<p>So the connection <code>db_connector.rb</code></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby">require <span style="color:#e6db74">&#39;mysql2&#39;</span>

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">create_db_client</span>
    client <span style="color:#f92672">=</span> <span style="color:#66d9ef">Mysql2</span><span style="color:#f92672">::</span><span style="color:#66d9ef">Client</span><span style="color:#f92672">.</span>new(
    <span style="color:#e6db74">:host</span> <span style="color:#f92672">=&gt;</span> <span style="color:#e6db74">&#34;localhost&#34;</span>,
    <span style="color:#e6db74">:username</span> <span style="color:#f92672">=&gt;</span> <span style="color:#66d9ef">ENV</span><span style="color:#f92672">[</span><span style="color:#e6db74">&#34;DB_USERNAME&#34;</span><span style="color:#f92672">]</span>,
    <span style="color:#e6db74">:password</span> <span style="color:#f92672">=&gt;</span> <span style="color:#66d9ef">ENV</span><span style="color:#f92672">[</span><span style="color:#e6db74">&#34;DB_PASSWORD&#34;</span><span style="color:#f92672">]</span>,
    <span style="color:#e6db74">:database</span> <span style="color:#f92672">=&gt;</span> <span style="color:#66d9ef">ENV</span><span style="color:#f92672">[</span><span style="color:#e6db74">&#34;DB_NAME&#34;</span><span style="color:#f92672">]</span>
    )
    client
<span style="color:#66d9ef">end</span>
</code></pre></div><p>and the <code>.env</code> you can fill it like this</p>
<pre><code>export DB_USERNAME=root
export DB_NAME=food_oms_db
export DB_PASSWORD=
</code></pre><p>And execute with <code>source .env</code> on your terminal and than we need routes. To understand routes,  I have share in the previous blog. Sinatra routes allow to field HTTP request from a user browser and send back based on URL a user visited and the type of HTTP request (GET, POST, PUSH etc).</p>
<p>After everything is done, next we need add the Models, Views and Controller to make application work. I went with one models, two views and a controllers.</p>
<h4 id="models">MODELS</h4>
<p>The model is the ‘logic’ of a web application. This is where data is manipulated and/or saved.</p>
<p>For first method, will return all items with instance variable and second method will insert to the new item to database with query mysql in the <code>clien.query</code>.</p>
<p>The models that I have is :</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby">require_relative <span style="color:#e6db74">&#39;../db/db_connector&#39;</span>

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Item</span>
	<span style="color:#66d9ef">attr_reader</span> <span style="color:#e6db74">:id</span>, <span style="color:#e6db74">:name</span>, <span style="color:#e6db74">:price</span>

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">initialize</span>(id, name, price)
        @id <span style="color:#f92672">=</span> id
        @name <span style="color:#f92672">=</span> name
        @price <span style="color:#f92672">=</span> price
    <span style="color:#66d9ef">end</span>

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">self</span><span style="color:#f92672">.</span><span style="color:#a6e22e">get_all_items</span>
        client <span style="color:#f92672">=</span> create_db_client
        rawData <span style="color:#f92672">=</span> client<span style="color:#f92672">.</span>query(<span style="color:#e6db74">&#34;select * from items&#34;</span>)
        items <span style="color:#f92672">=</span> Array<span style="color:#f92672">.</span>new
        rawData<span style="color:#f92672">.</span>each <span style="color:#66d9ef">do</span> <span style="color:#f92672">|</span>data<span style="color:#f92672">|</span>
            item <span style="color:#f92672">=</span> <span style="color:#66d9ef">Item</span><span style="color:#f92672">.</span>new(data<span style="color:#f92672">[</span><span style="color:#e6db74">&#34;id&#34;</span><span style="color:#f92672">]</span>, data<span style="color:#f92672">[</span><span style="color:#e6db74">&#34;name&#34;</span><span style="color:#f92672">]</span>, data<span style="color:#f92672">[</span><span style="color:#e6db74">&#34;price&#34;</span><span style="color:#f92672">]</span>)
            items<span style="color:#f92672">.</span>push(item)
        <span style="color:#66d9ef">end</span>
        items
    <span style="color:#66d9ef">end</span>

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">self</span><span style="color:#f92672">.</span><span style="color:#a6e22e">insert_item</span>(name, price, category)
        client <span style="color:#f92672">=</span> create_db_client
        new_item <span style="color:#f92672">=</span> client<span style="color:#f92672">.</span>query(<span style="color:#e6db74">&#34;insert into items (name, price) values (&#39;</span><span style="color:#e6db74">#{</span>name<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;, </span><span style="color:#e6db74">#{</span>price<span style="color:#e6db74">}</span><span style="color:#e6db74">)&#34;</span>)
        new_category <span style="color:#f92672">=</span> client<span style="color:#f92672">.</span>query(<span style="color:#e6db74">&#34;insert into item_categories (item_id, category_id) values ( LAST_INSERT_ID(), &#39;</span><span style="color:#e6db74">#{</span>category<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;)&#34;</span>)
    <span style="color:#66d9ef">end</span>
<span style="color:#66d9ef">end</span>

</code></pre></div><h4 id="views">VIEWS</h4>
<p>This is the user-facing part of a web application or ‘front-end’ — this is the only part of the app that the user interacts with directly. Views generally consist of HTML, CSS, and Javascript. I created two views, one for showing all item and one for form that we add new item.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">&lt;<span style="color:#f92672">h1</span>&gt;Daftar Item&lt;<span style="color:#f92672">h1</span>&gt;
&lt;<span style="color:#f92672">table</span>&gt;
        &lt;<span style="color:#f92672">tr</span>&gt;
            &lt;<span style="color:#f92672">th</span>&gt;Name&lt;/<span style="color:#f92672">th</span>&gt;
            &lt;<span style="color:#f92672">th</span>&gt;Price&lt;/<span style="color:#f92672">th</span>&gt; 
            &lt;<span style="color:#f92672">th</span>&gt;&lt;/<span style="color:#f92672">th</span>&gt;
            &lt;<span style="color:#f92672">th</span>&gt;&lt;/<span style="color:#f92672">th</span>&gt;
        &lt;/<span style="color:#f92672">tr</span>&gt;
    <span style="color:#960050;background-color:#1e0010">&lt;</span>% items.each do |item|%&gt;
        &lt;<span style="color:#f92672">tr</span>&gt;
            &lt;<span style="color:#f92672">td</span>&gt;<span style="color:#960050;background-color:#1e0010">&lt;</span>%= item.name %&gt; &lt;/<span style="color:#f92672">td</span>&gt;
            &lt;<span style="color:#f92672">td</span>&gt;Rp.<span style="color:#960050;background-color:#1e0010">&lt;</span>%= item.price %&gt;&lt;/<span style="color:#f92672">td</span>&gt;
        &lt;/<span style="color:#f92672">tr</span>&gt;
    <span style="color:#960050;background-color:#1e0010">&lt;</span>% end %&gt;  
&lt;/<span style="color:#f92672">table</span>&gt;
&lt;<span style="color:#f92672">a</span> <span style="color:#a6e22e">href</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/items/new&#34;</span>&gt;Add New Item&lt;/<span style="color:#f92672">a</span>&gt;
</code></pre></div><p>and form with file .erb to create new item</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">&lt;<span style="color:#f92672">h1</span>&gt;Create new item &lt;/<span style="color:#f92672">h1</span>&gt;
&lt;<span style="color:#f92672">form</span> <span style="color:#a6e22e">action</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/items/create&#34;</span> <span style="color:#a6e22e">method </span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;POST&#34;</span>&gt;
    &lt;<span style="color:#f92672">input</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text&#34;</span> <span style="color:#a6e22e">placeholder</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;name&#34;</span> <span style="color:#a6e22e">name</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;name&#34;</span>&gt;
    &lt;<span style="color:#f92672">input</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;name&#34;</span> <span style="color:#a6e22e">placeholder</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;price&#34;</span> <span style="color:#a6e22e">name</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;price&#34;</span>&gt;
    &lt;<span style="color:#f92672">button</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;submit&#34;</span>&gt;add Item&lt;/<span style="color:#f92672">button</span>&gt;
&lt;/<span style="color:#f92672">form</span>&gt;
</code></pre></div><h4 id="controllers">CONTROLLERS</h4>
<p>The controllers are the go-between for models and views. The controller relays data from the browser to the application, and from the application to the browser.</p>
<p>For first, will call method from model with <code>get_all_items</code> and return will send into views to showing, and in the second method we add the item into database from method <code>insert_item</code> from the models and we redirect in the views from router.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby">require <span style="color:#e6db74">&#39;./model/item&#39;</span>

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ItemController</span>
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">items</span>
    items <span style="color:#f92672">=</span> <span style="color:#66d9ef">Item</span><span style="color:#f92672">::</span>get_all_items
    renderer <span style="color:#f92672">=</span> <span style="color:#66d9ef">ERB</span><span style="color:#f92672">.</span>new(<span style="color:#66d9ef">File</span><span style="color:#f92672">.</span>read(<span style="color:#e6db74">&#34;./views/index.erb&#34;</span>))
    renderer<span style="color:#f92672">.</span>result(binding)
    <span style="color:#66d9ef">end</span>

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">create_item</span>(params)
        new_item <span style="color:#f92672">=</span> <span style="color:#66d9ef">Item</span><span style="color:#f92672">::</span>insert_item(params<span style="color:#f92672">[</span><span style="color:#e6db74">&#34;name&#34;</span><span style="color:#f92672">]</span>,params<span style="color:#f92672">[</span><span style="color:#e6db74">&#34;price&#34;</span><span style="color:#f92672">]</span>)
    <span style="color:#66d9ef">end</span>
<span style="color:#66d9ef">end</span>


</code></pre></div><p>Hopefully this blog helpful to you when you go on to building an application with the help of sinatra.</p>
<p>Thank you!</p>

      </div>
    </article>

    <hr />

    <div class="post-info">
      
    <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg>

        <span class="tag"><a href="https://hafiztsalavin.github.io/tags/learning/">learning</a></span>
        <span class="tag"><a href="https://hafiztsalavin.github.io/tags/bootcamp/">bootcamp</a></span>
        
    </p>

      
    <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-folder meta-icon"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path></svg>

        <span class="tag"><a href="https://hafiztsalavin.github.io/categories/development/">Development</a></span>
        
    </p>


      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text">
          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
          <polyline points="14 2 14 8 20 8"></polyline>
          <line x1="16" y1="13" x2="8" y2="13"></line>
          <line x1="16" y1="17" x2="8" y2="17"></line>
          <polyline points="10 9 9 9 8 9"></polyline>
        </svg>
        802 Words
      </p>

      <p> 
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar">
          <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
          <line x1="16" y1="2" x2="16" y2="6"></line>
          <line x1="8" y1="2" x2="8" y2="6"></line>
          <line x1="3" y1="10" x2="21" y2="10"></line>
        </svg>
        
          2021-07-25
        

         
          
        
      </p>
    </div>

    
    <div class="pagination">
        <div class="pagination__title">
            <span class="pagination__title-h"></span>
            <hr />
        </div>

        <div class="pagination__buttons">
            
            <span class="button previous">
                <a href="https://hafiztsalavin.github.io/posts/2021/07/unit-testing-with-rspec/">
                    <span class="button__icon">←</span>
                    <span class="button__text">Unit Testing with RSpec</span>
                </a>
            </span>
            

            
            <span class="button next">
                <a href="https://hafiztsalavin.github.io/posts/2021/07/2nd-weekly-reflection/">
                    <span class="button__text">2nd Weekly Reflection</span>
                    <span class="button__icon">→</span>
                </a>
            </span>
            
        </div>
    </div>


    

    

  </main>


            </div>

            
                <footer class="footer">
    
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2022</span>
            
        </div>
    </div>
    
    
    <div class="footer__inner">
        <div class="footer__content">
            <span>Powered by <a href="http://gohugo.io">Hugo</a></span><span>Made with &#10084; by <a href="https://github.com/hafiztsalavin">Hafiz Tsalavin</a></span>
        </div>
    </div>
    
</footer>

            
        </div>

        



<script type="text/javascript" src="https://hafiztsalavin.github.io/bundle.min.ace63d93098bf623f7c286a9084a4c22bfc482944c734f87fe0b685c7c6c7fa0ad2edb028c3b4b60d3343720c8ab490b320ad7f8edf4f6e9a6b898fc529057a9.js" integrity="sha512-rOY9kwmL9iP3woapCEpMIr/EgpRMc0&#43;H/gtoXHxsf6CtLtsCjDtLYNM0NyDIq0kLMgrX&#43;O309ummuJj8UpBXqQ=="></script>



    </body>
</html>
